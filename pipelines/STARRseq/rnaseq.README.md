# RNA-Seq pipeline
Here we provide the tools to perform paired end or single read RNA-Seq analysis including raw data quality control, differential expression (DE) analysis and functional annotation. As input files you may use either zipped fastq-files (.fastq.gz) or mapped read data (.bam files). In case of paired end reads, corresponding fastq files should be named using *.R1.fastq.gz* and *.R2.fastq.gz* suffixes.


## Pipeline Workflow
All analysis steps are illustrated in the pipeline [flowchart](https://viewer.diagrams.net/?highlight=0000ff&edit=_blank&layers=1&nav=1&title=NGSpipe2go_RNAseq_pipeline.html#R7V1Xk5vIFv41U2U%2FSEUOj5PkWV%2BH3Rnf8npfXA00EtdIYEAT%2FOtvR0RoJFAA5FlPlWfUIOhw%2BpzvxL5Qr5fP7xIQLz5GHgwvFMl7vlBvLhRF1gwd%2FcItL7TF0jTaME8Cj920aXgIfkHWKLHWdeDBtHRjFkVhFsTlRjdaraCbldpAkkRP5dv8KCy%2FNQZzWGt4cEFYb%2F0aeNmCtcqGvblwB4P5gr3aUkx6wQHuj3kSrVfsfatoBemVJeCPYWNMF8CLngpN6u2Fep1EUUb%2FWj5fwxBPK58x%2Br1Zw9W8ywlcZW2%2BsPilm39%2FuH95Dj8un%2BefJPfPv91J3rnshc8F9NDUsI9Rki2iebQC4e2m9YqMF%2BLHSujT%2F9bLmN8%2FBzFq2XzrQxShhhsZ3waz7IWtPFhnEWpaZMuQXYXPQfY3fuBUZ5%2B%2BFa7cPLN3kQ8v%2FMMqS14KX8IfvxWvbb5GPvHvpVkS%2FcjXGa3DVX0q2eym0Tpx2bw8up%2F%2Bevi6fr%2B%2B%2BfXPlz%2B%2BzL6lj%2F9MVEYgGUjmMNtyo8YmGs9u4RVsqd7BaAlRH9ENCQxBFjyWCRMw%2Bp7n920WGv3B1lq87nfSe3%2FxycrCx8W98%2BnuYfb9192Eb7xHEK7Zqy4UI0QjuPKCR%2FzGMJivyAXj5xqT6FVCyD%2F%2FiP6as9%2Fka05SbUEdI8%2FirRU6K6x%2BCBwYXuVb6ToKo4TcpM7IP%2BGi%2BdEqY%2FQkG7jfIF0QopRLJIo%2F%2BUEYFh%2Bq4J%2F8ofwK2bvq1TwBXoAIodLsRsvAZRQ0D0Gacmri21oir83Q4kV44ia2tI2yHmGSweetlMCuWjrjNYy3TmyDfn4qcCpLoW2LApPS%2BCIfQj1CYpZfNfncGvjnFORzBGpRLKlELbIu1ahFk%2Bw6tRjmEajlLyv%2BemM792ESfHU%2BvVPX%2F1zDiXmwiOlJoDQJhgrP3lNS1AWFcLaMnsSC8OX2uSzVRvaXJP9U7Sz7S%2Fv%2BtOstvk8dcsHlw%2FHfyFe8tL6j2OF6Twu%2BrZMCwY0FYokSuKjGFyYpWctLdIOsxc8COX6tXFwWZTd9XFmkH%2FgKDhV4w%2F2ny8kD%2FIm%2B8GcQwzDAqlf%2BfqfYs6vtOEPUV4pjDuzqYQOeEMoMMuCgbyOazAcpedAPVgFBmmi98X%2B9zPxxnpLGYNW4prwB4J0UZJX3JCuQwp9TPhNTBPiix5fiqzj18xagA1fVDBfajuSZDpB0W7M13%2FR93TYkRZq4NvB06Oq%2B7CmmanqWKZmG73i%2BrkuSAzVN80ygQqf0kkUC%2FdJrFlmGTRWXeHMqs3mQLdbOFGE%2B9CFYOn6EWAL689O7B9x1ZR5hAg0jB29hkGYQEeWMDypFfyPKTjFhz3YPmE5b432cKICA7GuTjtpEi9NAU83NJdw%2Bqu0URsBLCbNNY%2BgSdqtIDp42bLKJvHWI5%2F%2F8xwfTFMmvAGB5AFZePrgJHnbgI1WEyDiAhAomvj0GfATW9gzddYbnu8jazoCRoe2Mvxys5oQvv0nhW%2FSLNMYgSCCebkgm%2FU1MLnkwxepwx%2B3UrPAeQ0%2B05ZKeyJ9QUBNVU6AmysqpjAqaAJlUpgApyzH%2BEzHWGKnVePAUaXJEZ%2FGG3FirCadrKzRqPYf1KeOTU5wx3tYa37H3%2FRkFhEjZyyaKXlows%2FyAyPdThDqri5B3%2BgBjz6BKIf%2F7W0ld6KYi5NbhHgzCRlu1T6h4DKUVGI1aQZNcc6JnzCcRD6Sc0okSDyYT1Ix5OAFJbF8QPiqhTaDnV4pek0vC81Wo4Z%2F8jhh4Xv5spZU2sA1eitGki9htguBXOs2eS6bJKoj0bMOTTd0zTCADS9JkS1YQjpQ1R7EAVMHE9F3Jkm0feJqkmB5QFE21VcOVZN1FQNN2dEmXfIQZBwGRjeOkk1S9vA0yNsBDEZIUYAauydTJqZlWqhIZLkuT6CLqRp1yCbEUHijV7spJqnCX0kxXmRN5L7XGmvaYedWWoAwTbm4JBAPhSxqgVUH7U5pT2ElchRKffUz0eAklioPQfQZYYm%2FaykljOgoE66d0Fv7z%2BTH9%2BgUN5c1%2FPk%2B%2Bfnk7Lcx7IFiLei%2FrLULNuH4bbqzPQpd5eYd2fowGsULoM6XcjCmxlGtW6XCsA2r5%2FFfSMdwo2jK4nW77BlyL8VbggvCSuYwyjBCuuAMphD7%2BVoTu8kPiKMHemDJWeFoEGXxATAA%2F8SkB8TYJ3gEilz0pqqwI8J5cB3zWydxu%2Br9IrD0S48s1Gij23xQmn53%2F4fgVxOWxz%2FL1QK0yZ28EWrprmabhK74va5qt%2B7rqykC3Fdv0fc%2FXnImMSNlRHNtB4MoBqmabsqZDxfI9z%2FJNWYKuCxXN04cBWg2jpBMkFm7%2FgqxOICtFmCjMzfx7C7qg%2BjwCRjpjjs4SGsmuI3Y%2BgcBz0dbG%2FAQ%2FmY5BKuDON%2BtV8HNNqGHtTBB3xWuD2QURNl70dtuQTwVT5hT%2FHWsW5gU4iVG1j0dbIpM%2BB5fAOERoJjvqMuePxPzyRIPqht%2B24xSlIEAZsDlDwJdHf%2B4CfPIeYAB9LOCBDiBQsf4Fge1BIDcinw0IjIWSe4m6jzRkIpyleIP7aPuE7CB8zShcQ0SfTdiuuiTieUV9PbvQ3caZLnQR1WCIkOvE1bZF7a69hkrZA75oiaHq1cXGhwRagT%2B0CtMkjKcrbD9vBICTtiAwd71NH0GSNnpsm26rA0OG27tM9mmmtiKX4iR6DDxMJkVvo4hktgoq0gPinPyEvliajdLIBe%2BlX8NjFXo1pTdRnE27Y5zCdO6Udcp2WTc%2BqaZxlrhLqtlmZ%2Ba2v1AThSX16vzjLxyt908rr2L5AUfx%2FokDBF8r2jhKSCBfp3bwYyjvnyJyvY8RjrjRyg%2Fm64TkWBTjdESmkVeBQOiM4Av4vin92Ig5xDc1mqIa7FDC%2BL1k4PHHCQRLpKY2Ay7BHccYeX%2Fwa3Bki1Mym%2Be3crVxbuuQa5SzXQGdtQYSgouZ0lOU%2FMBhd%2BTZKzAnyHMb5hS1HdKQQCqH0g7vfXO8DqKJAOsQY5WA9YDNZRquk5IdGfu%2BA2yeW0X49hWEHomVS3e%2FBBMwCxhkaVj8sWHkYr2jsICtxoXD8mhgpOiqQMXI2Uf%2BRUzwWIlHHWDyCCkcePF%2FQIhpcjMxCJtlwWqe7vTTVzSPUSsSumoKELAAAsuGeirgog%2BuNmhdZ%2FGVqA31hfjN9IYe84pap5KdKHdwl80yR98zBB%2F%2BuiZitY258OcacbXs5YIFQRFuStw3CXgi3Sax7LizCIr8oO88IsbJw%2F3xreh%2FH1346U4X6LX4%2Bk7TTylzr276ETGeChdnPtUP5NONajTwbpKqzB4slSn%2BCGxdl6wSj5B5InAxv9wQ8CjedmQD0a%2Bv2c0X6e9%2F3s%2Fub5Ol7H159%2FLH5GwiX1olmO7FBdqaErSjuzLIVy%2BTBLwUboixpEmbRY9WSURXWdL5rO39ml0hJNqDfcWUkKx2xLbD0Ime%2FiWpCa8hMDKS0nTl9CSyo0LOvyTCuI49ThKR%2ByCR7UbyV0IiR1752tLqctWRZZcfQWmUfWuz5gcLLqMHQcQx%2FvjrMBy1elZr7mIcm8ba2h3Eq7U9BucsNnyu9%2BYf6EOVXYpvH8ttDsNSDKMflqJZx2UpwtJ%2Bg5ZdOrc4sdakqR4d5xxqdHn4cnnf2uRyD5mjIo5JKHAPxpXcfZSiye1gXdEK83pK68qJ8%2Bp5Ev1A1pQthsI9Hf6kJAJzqUl7OPg%2Fr7N4TULWoxCTwoZ0C3Qr%2FXTH6d7P%2FUFRPoyAOoVo2P2m321Cyw6Pii6WMeRlDWdgGYSY%2Fu5g%2BAjxUy%2F68A%2BZWrlQparrNdIXOoj2IP2WdG6OjM6lGqknMF2H2UhjWYrJJem27pzi5V7g%2BzDJ40rhc4zmKqUlr%2Bqz1kuX3n3GHVklgbtYwtXm%2FePd6ifY1rpUl2jCbX2yPFiufo14W4fRfKR7GvVswkWWG4Uhgg4kCIOKLwjcxcUm6uG3J2ZN7VFGpb8s63kmBbr6jzy%2FWd6ny7vV6Cqwd9PcvEtcfR%2FjcFzTGFc4xo0zssbMssDL%2FWP8zfRpmAQkRP8hzyk9tj7Hy63v1OfswSxLW%2Fs9GtZWR%2BYJjBF5jZS7laMk2%2Ben39zSYU3vl17xqdUEdcdzZAu6vmK6im85wHN8V7EBtHUTSrYkT2THUWwbegaaZdUCku06li5Lhu35wDVlWdMsYJl6%2BSWnSFAn4Zjod75cs3QRrF6%2B00qR32kz2nzfaRjbrGkG6OxVrjYGdzaEbTaFB3dZoCnpP%2BrGdAHDGCbp9H7bSgHZcqFsepZluqrtyqrq6qrq2R60JM9z1YnrKJICZQBl2ZRdz%2FRtXTWBbKuWY%2FuajRdMkUzTGeFK7ZgKvmTi27quXV%2Fg%2Bk%2FUUcTpcw6D%2BVCCJ7JYHZIgl2mBgvIoyo8RUhgwoyYUKtFMeyTWM4xn3HWakUdtCjFtEsUKEZ1oedMFYn55WSIeo7pn1Obvp9QbHNXvjPpUlcNlpDgW6PAM6CJiYgc09A%2BZ2Is3eOmkbtoThQXVfB0mVw8rcTy7fCq73R6tLeLBChsOnmMCM1dZa%2BO4h7nBkjIatA6UJ%2FDUUhqoSMITw8BJACPk3qznlUG1N6RrfYUpnjYsUZWHNaSLWdHhtVGHY0UVd3BXvnQAK9KHYUVtI0aOyIpqDenawXHNCgJ32UsMxWpUR28eMdPSyj60hCRiGhjNvMSwXx5VHVwHJlU8FOOMmZQ9QibFfdvjjy0aw4l%2BWtsKztrR497aomJhuIcx5CKfW7hH60VWTxOJ1DmAiPMLzmfKAUQ779cPC6ZvLe6YAPhOHYeHijEfgmydDCPDOoiuYtbV%2BYiuaqCKqo9QdCnb8fU4Ai2Px9COpeqbLbmbJfckwvbHyw5YXmMDGT7A%2BRCo7KJNTSooOsH8azDvM68QDcFlQ%2BjAVczfgqvotjWte1gH5yvqOfCVowIeazDAcyhLePf5%2B20ectN6v2%2BidMpW%2F0Jx3Dkk9U36BBelsXRgBtbvwQwGNuFd3cny9fxXoC3vVO9%2B5i0%2FPHvDHnl7Hua606T27TTX5YFm%2FZnrvHV8DzyQ7OUyQF8mdZpZiCKBG30yF%2FT%2BBHe%2BA1%2Bxz5KvVK1u2sAx9kJ7jHx4Rt%2BAcV0nrImyDwvS24ZzqUcP59rLXmNWKFTfYa%2Bp3q9aeoUmT2OvwRDoKvJekIqltOZ5CTfXcLVMwn8xQIVfCFdzHHXRJ%2B%2FDr8bV61GnlPb8j5LV2fM%2FfYymG3XQki1n53VonRpr9aSftZNyZ1OXZxReh9ZJpuP0OmjGdik2lNfh5vb7ze0D%2FNlehN1syS3aGAt6Be8Q%2Fe4gurTfIz1WU4cVXVvN4qMJwq%2FnF2UJcH%2BMNAafWtjxkFknmdHtMUhxwb%2BUacivMXVOaA0%2FWb6RsDLnoMEgZ1%2FQ3zqLgv68l%2BMs6H8Piex1sa74Dq6ipdiz15JB9J9dRApu4BOLPfhMUifnpUFUc13yKAaJlAwPCPcj75hnft9JFrW0iU2la5YxUSxnTQ5l3nVQ0V5n6oy6srUp1ytbyzyyr5TjIB2BS4t38OCVrXMe8norW4vzdbcX%2B%2Bvdrlu2dORS9Kgidbx5vrYgkE%2B4bPK48nzt5go853MMdJ4USshyuy7y2g4qplNSrhKEfr1BJI5WjVZcoNmN5dRanrH4AwGF5O3mM0IOxFSRVz6hqUiAkJqokDrNXipEPqQZjNPiARRtDqE91TG5HZ%2F%2FSjp20ekM3nM4UtfmFRV5%2BihnfEVoxe0tR4dWQgV40EqrZ68Ay7J%2BDhpw3s1BbHh%2FrNrU0QBPHsjAOG145CyMi01xuze%2FgjiG3tttPetFX12BJU0RQJLuEeulxGZPDYwxCKhkhQzmtM3a77H%2F9GR6eXovT8kcT%2Be%2Fxt1PZY9%2BnrXRtmIM4B931js4mS2Au0hG7I7A9WRLZTJGxMocsLyolDB8VU4HUQXafkucnX0larPPKAHuId0dCnL0U1kODdUn9YbuWRmjtr54NiFYolM7NJHlaG%2F%2F8KInWuyTlgPCve4tC5BVTsIjae%2BUt4sLcL5OeVMb1il%2FJ733F5%2BsLHxc3Duf7h5m33%2Fd8YPIBUKwRluY0QoFSdV6pInkxQc4x%2FhxQ7v0cTV54TTKCyxby4tE%2BcN1FJLDS1nEPhYTlSZODUwaq1dV0bMMPI%2FwRxFVlHnmUUSJWhYlao0uNB6LKLLxHyJJhESg1oiAHGl9salY2sJHsnvLHWPqrIrr36pvKZF7RDvV1B3iEjaqILJgTOWzuWkk8yrSMJBKgTU4J8W%2F4uKx7nxxBgeLeyLELpa2ExBXbu0oUpcmoi79RNTVp7tyK3m%2FXm%2BlcFrO0M3ELN0z6jHZsh1fm0tp62S8Wp%2FJaDs2oDPnCCKm6rgR4ReRhFG1Zt54kIQZ8iiPgNrzZ1HFGDbKELVXYOKqEqcsay3xj3Ei6mw%2BkSI3lf%2BRoel0izHbGys6Wc91SrLoGLHlpYd%2FW%2BWyCmINpd0inky7rNvZb2hCK7E7QRoR6eEUb4wxREEXJMbiFS2ZyLTMjzItOUfsw5dMaFo%2Bm%2BoNx3Pm16MHG1e2aGv%2BZofvvwR%2F3DoPD8%2FRS%2FTy%2Ftvn%2F07ampr5iTtDp1VXA3XVUpr0zvs1o5%2B0anauDrFxfMAnAbWuUhXFL2Q90h%2F4FeQQIQmRXyGQjDVyBNKDUXwZpFi9ASsYrfFnNjpieUun9L6pOHWtmejOzkheTbo2pWHrWgnTcQVml4GDkzvxSPQhjxmu8s2uxxTv6ZITUmzbpB%2FuRxlJcrYyshIkR6SGihRV%2ByeGoXOzeYYIZ0dM1AlFW%2F3g6yozq2LqvUsttYNtXF%2F7DSmzwqcGZlPi2R%2BKS23rdSvXwToJX65wVjHMdgv9Db3QTxlNPFZvJnbHmW%2BPEjRTnZY3Zr5RSzpSHSao5hF8M%2BLlPrxIxwkrUSldi2B2qoPXajP1s0kaVJRq0Tu7HSfurDrJZVXIsPtRhT6uwyz467p9NNB6uQQJJiFFQl%2FLA%2Fd60HNotd4l7vBPV6jONBPK2akz1Zgf0blefaozW5P2Gt2X9eCDhPS0m1m85EiscMrCrBMyv8o9nNxUd6GoM%2FJPyK2KFnKjyr3KEqpo%2F0MPvTXwT5OxcJ4AL0DLX2lGZIaTMwnvm%2BNUTc5GF8AjXFISicIj0JOtSNNqWUZVy5uKws%2B0p9xLVLIRWvr0VCJQac4GaSKkxigW8q11WG0Jc2v%2BX1XDMDltMIxo1h6NaCQV9EL4CIt5k2EtrH7TAjwQE4YlZQh4shyIN1GM1xGEb7fS97bnsrMXcAA3fWaKaSPNyp6KbU%2F47%2FUD5tO8koOEyOspZT0tFqnZt2s%2F12CV4RPYdteN2fa0D%2FzQNhJuFGKQQeVnCtN0WQ4%2B2torcrYSSYMmK4krR6Fvlzq34xHvaJ1E6hwu1FFs9eUHkpjBgQf0VpB0BPGONT6zjh7m7eAHf7x5KBAezQdFUi1Da73%2FomyrnPXm5vbthaDaNjtCj%2FSMbAkke%2Ffvwe3uyt55kuyer7j0vIBurPIrgpUbrj26TwhO4HkPZEd3fR9qrLORHeLocFcSAx3DOpLsSmCpatfRhyKLfH%2BGdbiIEKaFyofXdRi5K6lVdd6uSaLCuWydImqIqaS3hIUZTm17cBMIVx18NMsYZgHpX1FwUv6D%2BRtOUQRMG%2BtJayE5eikZiFBzaV6mHjQXgoHZgyWRJlNjHAKya%2B2YUQYuKSic6sOPLD7TYrhH4SetT2vTxJRyan4iiETNGcj1OiPYncH16dtGRiNtxQ%2BCdxSaLgXqQTOg6IUluWzg7fnRYAepHcR%2FqpYU2bb7PfIINSVRlBVNd2ici4%2BRh%2Bn09v8%3D). Specify the desired analysis details for your data in the *essential.vars.groovy* file (see below) and run the pipeline *rnaseq.pipeline.groovy* as described [here](https://gitlab.rlp.net/imbforge/NGSpipe2go/-/blob/master/README.md). A markdown file *DEreport.Rmd* will be generated in the output reports folder after running the pipeline. Subsequently, the *DEreport.Rmd* file can be converted to a final html report using the *knitr* R-package.


### The pipelines includes
- quality control of rawdata with FastQC and MultiQC
- adapter trimming with Cutadapt (optional)
- Competitive mapping to rRNAs and other contaminants (optional)
- Read mapping to the reference genome using STAR
- generation of bigWig tracks for visualisation of alignment with deeptools
- Characterization of insert size for paired-end libraries
- Read quantification with featureCounts (Subread) 
- Library complexity assessment with dupRadar
- RNA class representation
- Check for strand specificity
- Visualization of gene body coverage
- Illustration of sample relatedness with MDS plots and heatmaps
- Differential Expression Analysis for depicted group comparisons with DESeq2
- Enrichment analysis for DE results with clusterProfiler and ReactomePA
- Additional DE analysis including multimapped reads


### Pipeline parameter settings
- targets.txt: tab-separated txt-file giving information about the analysed samples. The following columns are required 
  - sample: sample identifier for use in plots and and tables
  - file: read counts file name (a unique sub-string of the file name is sufficient, this sub-string is grepped against the count file names produced by the pipeline) 
  - group: variable for sample grouping (e.g. by condition)
  - replicate: replicate number of samples belonging to the same group
- contrasts.txt: indicate intended group comparisons for differential expression analysis, e.g. *KOvsWT=(KO-WT)* if targets.txt contains the groups *KO* and *WT*. Give 1 contrast per line.  
- essential.vars.groovy: essential parameter describing the experiment including: 
  - ESSENTIAL_PROJECT: your project folder name
  - ESSENTIAL_STAR_REF: path to STAR indexed reference genome
  - ESSENTIAL_GENESGTF: properly formatted GTF annotation file having *different* gene and trancript IDs (e.g. from Ensembl or Gencode)
  - ESSENTIAL_PAIRED: either paired end ("yes") or single read ("no") design
  - ESSENTIAL_STRANDED: strandness of library (no|yes|reverse)
  - ESSENTIAL_ORG: UCSC organism name
  - ESSENTIAL_READLENGTH: read length of library
  - ESSENTIAL_THREADS: number of threads for parallel tasks
- additional (more specialized) parameter can be given in the header-files of the individual pipeline modules 


## Programs required
- Bedtools
- Cutadapt (optional)
- DEseq2
- deeptools
- dupRadar (provided by another project from imbforge)
- FastQC
- FastQScreen (optional)
- MultiQC
- Picard
- R packages DESeq2, clusterProfiler, ReactomePA
- RSeQC
- Samtools
- STAR
- Subread
- UCSC utilities
